---
subDocuments:
  - rules
  - optimixation
---

# تنظیمات CDN یا شبکه توزیع محتوا (گام دوم)

در این بخش می‌توانید قوانین و تنظیمات مربوط به چگونگی کارکرد cdn برای سرعت بخشی به وبسایت خود را تنظیم کنید.

![CDN: cdn settings](img/cdn-settings.png)

## سطح عملیات Cache

با انتخاب سطح کش در کوبیت، می‌توانید به شکل دقیق مشخص کنید که چه محتوایی از سایت شما در لبه‌های شبکه کوبیت (Kubit Network Edge) ذخیره (Cache) شود. این کار باعث می‌شود سرعت پاسخ‌گویی به کاربران به طرز چشم‌گیری افزایش یابد، مصرف منابع سرور کاهش پیدا کند و تجربه کاربری روان‌تری رقم بخورد.

1. **خاموش**
   در این حالت، هیچ محتوایی در سرورهای کوبیت کش نمی‌شود. تمامی درخواست‌ها مستقیماً به سرورهای اصلی شما هدایت می‌شوند. این گزینه مناسب مواقعی است که به هر دلیل نمی‌خواهید از کش استفاده کنید؛ مثلاً در فازهای خاص توسعه یا عیب‌یابی دقیق.
2. **بدون QueryString**
   مفهوم «بدون QueryString» به این معناست که کوبیت هنگام ذخیره‌سازی فایل‌ها، پارامترهای انتهای URL (مانند `?v=2` یا `?utm_source=...`) را نادیده می‌گیرد و صرفاً بر اساس مسیر اصلی فایل آن را ذخیره می‌کند. این کار باعث می‌شود نسخه‌های تکراری از یک فایل صرفاً به‌دلیل تفاوت در پارامترها کش نشوند، که در نهایت منجر به کاهش مصرف حافظه کش و افزایش کارایی می‌شود. این گزینه زمانی کاربرد دارد که پارامترهای URL فقط برای اهداف تحلیلی، ردیابی یا پاک‌سازی کش مرورگر استفاده می‌شوند و محتوای واقعی فایل تغییری نکرده است. برای مثال، فایل‌های استاتیک مانند CSS و JS که به‌ندرت تغییر می‌کنند، لینک داخلی صفحه یا لینک‌هایی که حاوی کد تخفیف یا رفرال هستند ولی به یک فایل یکسان اشاره دارند، بهتر است فقط یک‌بار ذخیره شوند.

   - **ذخیره فایل‌های کم تغییر:** فایل‌های استاتیک مانند CSS یا JS که به‌ندرت تغییر می‌کنند
   - **عدم ذخیره محتوای تکراری:** نادیده گرفتن کوئری‌های بازاریابی یا رهگیری مانند `utm_source`، `referral_code` و سایر پارامترهایی که تغییری در محتوای فایل ایجاد نمی‌کنند.

3. **با QueryString**
   در این حالت، برای هر ترکیب متفاوت از پارامترهای آدرس، یک نسخه کش جداگانه ساخته می‌شود. این گزینه برای شرایطی مناسب است که پارامترها واقعاً محتوای صفحه یا فایل را تغییر می‌دهند. مزیت آن دقت بالا در کش محتواهای متغیر و شخصی‌سازی‌شده است. موارد استفاده پیشنهادی:

   - **نتایج جستجو:** کش کردن کوئری‌های پرتکرار برای سرعت بیشتر.
   - **صفحات چندبخشی:** مثل `?page=2` یا `?limit=50` برای جلوگیری از تولید مکرر محتوا.
   - **فیلترها در فروشگاه‌ها:** مثل `?category=shoes&color=black` که هر فیلتر ترکیب جدیدی از محتوا را نمایش می‌دهد.

## حذف اطلاعات Cache شده

این امکان حیاتی در کوبیت به شما کمک می‌کند که هر زمان که نیاز داشتید، اطلاعات کش‌شده را پاک‌سازی کرده و نسخه‌های به‌روز محتوای خود را از سرور اصلی منتشر کنید.

- **پاک‌کردن گزینشی با URL**
  تنها کافی‌ست URL دقیق فایل یا صفحه‌ای که نیاز به به‌روزرسانی دارد وارد کنید تا کش مربوط به آن به‌صورت هدفمند پاک شود. این روش برای انتشار سریع تغییرات بدون نیاز به حذف کل کش سایت، فوق‌العاده کاربردی است.
- **پاک‌کردن همه‌چیز**
  با یک کلیک، تمام داده‌های کش‌شده روی شبکه کوبیت حذف می‌شوند و از آن لحظه به بعد، تمامی درخواست‌ها مستقیم از سرور اصلی پاسخ داده خواهند شد. از این گزینه معمولاً در مواقع بحرانی یا تغییرات اساسی استفاده می‌شود.

## مدت زمان اعتبار اطلاعات Cache شده

شما می‌توانید درخواست دهید هر نوع محتوا تا چه مدت در کش کوبیت باقی بماند. این مدت زمان به صورت انعطاف‌پذیر قابل تنظیم است و نقش کلیدی در کنترل به‌روز بودن محتوای سایت ایفا می‌کند، در عین حال که عملکرد را بهینه نگه می‌دارد.

## صفحات خطا Cache

در صورت مواجهه با خطاهای HTTP مانند 404 (یافت نشدن) یا 500 (خطای داخلی سرور)، کوبیت این قابلیت را دارد که پاسخ‌های خطادار را برای مدت مشخصی در کش نگه دارد. این کار می‌تواند از ارسال مکرر درخواست‌های مشابه به سرور اصلی جلوگیری کرده و در مواقع بحرانی، مانند قطعی موقت سایت یا افزایش ناگهانی ترافیک، به کاهش فشار بر زیرساخت کمک کند.

با این حال، انتخاب مدت زمان کش‌کردن این نوع خطاها نیاز به دقت دارد. به‌عنوان مثال اگر صفحه‌ای مانند محصول یا دسته‌بندی که معمولاً در دسترس است به‌طور موقت خطا دهد، نباید خطای آن برای مدت طولانی کش شود؛ چراکه این صفحات احتمالاً در زمان کوتاهی بازیابی می‌شوند.

بنابراین، تنظیم دقیق مدت زمان کش برای هر نوع خطا می‌تواند هم در بهبود تجربه کاربر و هم در حفظ سلامت زیرساخت سرور مؤثر باشد.

## مدت زمان Cache اطلاعات در مرورگر

علاوه بر کش سمت کوبیت، شما می‌توانید زمان نگه‌داری فایل‌ها در حافظه مرورگر کاربران نهایی را هم تعیین کنید. این موضوع باعث افزایش سرعت بارگذاری صفحات در بازدیدهای بعدی می‌شود و مصرف پهنای باند را کاهش می‌دهد.

## حداکثر اندازه کش

هر فایل یا محتوا تا سقف مشخصی می‌تواند در شبکه کش شود. با افزایش این اندازه، فایل‌های حجیم‌تری مانند ویدیوها یا اپلیکیشن‌های وب پیشرفته نیز در کوبیت ذخیره می‌شوند.

مقادیر قابل انتخاب: `128MB` | `256MB` | `512MB` | `2048MB`

## دسترسی همیشگی (Always Online)

با فعال‌سازی این ویژگی، در صورت از کار افتادن سرور یا سایت شما، کوبیت می‌تواند آخرین نسخه کش‌شده‌ی صفحات را به بازدیدکنندگان نمایش دهد. این قابلیت به‌ویژه در مواقع قطع برق، حملات DDoS یا بروزرسانی‌های غیرمنتظره، پایداری تجربه کاربران را حفظ می‌کند.

## کش صفحات با Set-Cookie

در حالت پیش‌فرض، صفحاتی که هدر `Set-Cookie` دارند (مثلاً برای کاربران لاگین شده)، کش نمی‌شوند. با فعال‌سازی این گزینه، می‌توانید اجازه دهید حتی این صفحات نیز کش شوند؛ البته با دقت در مدیریت امنیت و به‌روزرسانی محتوا. (توضیح)

## حالت توسعه (Development Mode)

در طول توسعه سایت یا اعمال تغییرات مکرر، ممکن است کش باعث نمایش نسخه‌های قدیمی شود. با فعال‌سازی این حالت، تمام کش‌ها به صورت موقت غیرفعال شده و تغییرات به‌صورت لحظه‌ای نمایش داده می‌شوند. این گزینه برای توسعه‌دهندگان وب، ابزاری ارزشمند است.
