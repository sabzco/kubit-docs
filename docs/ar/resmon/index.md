# ریسمان (رصد الموارد)

## التعاريف الموجودة في هذا المستند

- الفرعيات في الكلاستر: تشمل العقدة، مساحة الأسماء، تحميل العمل، الحاوية، والحاوية.
- أنواع الموارد: المعالج، الذاكرة، القرص (بما في ذلك نوعين: SSD و HDD).
- المعلمات المستلمة لكل مورد: تختلف حسب الفروع المختلفة للكلاستر ونوع المورد:

|      المصدر      | Node                                                                                                                    | Non-Node                                         |
| :--------------: | ----------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------ |
| المعالج والذاكرة | السعة - الكمية الحدية - الكمية المطلوبة - الكمية المستخدمة - الكمية المستخدمة أكثر من المطلوبة - إجمالي استخدام الأطفال | الحد - الطلب - المستخدم - المستخدم أكثر من الطلب |
|      القرص       | المخصص - إجمالي سعة الأطفال - الكمية المستخدمة - القدرة - الكمية المتوفرة                                               | المستخدم - السعة - المتاح                        |

بمعنى آخر، كل معلمة متاحة في موارد محددة:

|              | Disk Unbound | Disk Unbound | Processor and Memory Unbound | Processor and Memory Unbound | توضيح                                                |
| ------------ | ------------ | ------------ | ---------------------------- | ---------------------------- | ---------------------------------------------------- |
| Capacity     | \*           | \*           | \*                           |                              |                                                      |
| Limit        | \*           | \*           |                              |                              | إذا كان صفرًا أو ليس له قيمة، فهذا يعني أنه لا نهائي |
| Request      | \*           | \*           |                              |                              |                                                      |
| Used         | \*           | \*           | \*                           | \*                           |                                                      |
| Over Request | \*           | \*           |                              |                              |                                                      |
| Available    |              |              | \*                           | \*                           |                                                      |
| Allocated    |              |              | \*                           |                              |                                                      |
| Child Cap    |              |              | \*                           |                              |                                                      |
| Child Used   | \*           |              |                              |                              |                                                      |

أجزاء الرسم البياني: يتضمن كل رسم بياني يعرض حالة الموارد أقسامًا بألوان مختلفة. فيما يلي نرى الاسم واللون والملصق وإمكانية وجودها في ظروف مختلفة:

|                          | Label         | Color                | Node processor and memory | Non-node processor and memory | Node Disk | Non-node disk |
| ------------------------ | ------------- | -------------------- | ------------------------- | ----------------------------- | --------- | ------------- |
| Use without any problems | Ok            | Green                | \*                        | \*                            |           |               |
| Excess use               | Over Req      | Orange               | \*                        | \*                            |           |               |
| Improper use             | Over Lim      | Red                  | \*                        | \*                            |           |               |
| Not used                 | Not Used      | Blue                 | \*                        | \*                            | \*        |               |
| Not allocated            | Unallocated   | White                | \*                        |                               | \*        |               |
| Other                    | Other         | Gray                 | \*                        |                               | \*        |               |
| Used                     | Used          | Green - Orange - Red |                           |                               | \*        | \*            |
| Available                | Available     | White                |                           |                               |           | \*            |
| Out of reach             | Not Available | Gray                 |                           |                               |           | \*            |

مؤشرات الرسم البياني: يمثل كل رسم بياني حالة الموارد، بما في ذلك مؤشر أو أكثر بألوان وقيم مختلفة:

|                    | Processor and memory | Disk | توضيح                                                   |
| ------------------ | -------------------- | ---- | ------------------------------------------------------- |
| Request indicator  | Blue                 |      | إذا كان موقع علامتين متساويًا، فسيتم عرض علامة الحد فقط |
| Limit indicator    | Red                  |      | إذا كان موقع علامتين متساويًا، فسيتم عرض علامة الحد فقط |
| Capacity indicator |                      | Red  |                                                         |

## صفحة رصد الموارد

الوظيفة الرئيسية للصفحة: عرض حالة الموارد في مجموعة
الإعدادات المتاحة:

- اختيار المجموعة
- اختيار وضع العرض في خيارين: افتراضي ومقاس
- البحث (تصفية) حسب أسماء الأقسام الفرعية لمجموعة
- اختيار تصنيف الموارد بناءً على العقدة أو مساحة الأسماء

من خلال اختيار الإعدادات أعلاه، سنصل إلى عرض محدد لحالة الموارد. كل عرض هو جدول حيث تمثل الصفوف الهيكل الهرمي للموارد، وتمثل الأعمدة نوع المورد. في كل من أوضاع التصنيف المختلفة، يتضمن الهيكل الهرمي ما يلي:

| Tree Structure Column Name             | Classification Type |
| -------------------------------------- | ------------------- |
| Node - Pod - Container                 | Node                |
| Namespace - Workload - Pod - Container | Namespace           |

كل خلية من هذا الجدول هي مخطط يعرض حالة مورد محدد يستخدمه قسم فرعي من المجموعة المختارة، استنادًا إلى المعلمات المستلمة، وله معنى مختلف اعتمادًا على وضع العرض المختار.

### تفسير كل خلية في الجدول في وضع العرض الافتراضي

في هذا الوضع، تحتوي جميع المخططات الموجودة في الخلايا المختلفة على نفس الطول. يختلف طول المخطط في الأقسام الفرعية المختلفة للمجموعة ويعتمد على نوع المورد:

|                      | Node     | Non-Node                          |
| -------------------- | -------- | --------------------------------- |
| Processor and Memory | Capacity | Maximum Limit and (Usage + Cache) |
| Disk                 | Capacity | Capacity                          |

كل مخطط يتكون من عدة أجزاء وواحد أو أكثر من العلامات. إجمالي طول الأجزاء المختلفة يساوي 100 بالمائة من طول المخطط، ويكون طول كل جزء كما يلي:

| علامة          | Node Processor and Memory                                                | Processor and Non-Node Memory                                            | Node Disk                                                                                                                                                                                      | Non-Node Disk                                                                                                                                                                                  |
| -------------- | ------------------------------------------------------------------------ | ------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Ok             | Minimum Limit and (Usage minus Excess Usage) (Zero Limit means Infinite) | Minimum Limit and (Usage minus Excess Usage) (Zero Limit means Infinite) |                                                                                                                                                                                                |                                                                                                                                                                                                |
| Over Req       | Minimum Excess Usage and (Limit minus Okay)                              | Minimum Excess Usage and (Limit minus Okay)                              |                                                                                                                                                                                                |                                                                                                                                                                                                |
| Over Lim       | Usage minus Limit                                                        | Usage minus Limit                                                        |                                                                                                                                                                                                |                                                                                                                                                                                                |
| Not Used       | Limit minus Usage                                                        | Limit minus Usage                                                        | (Minimum Node Capacity and Total Capacity of Children) minus Allocated                                                                                                                         |                                                                                                                                                                                                |
| Unallocated    | Node Capacity minus Limit                                                |                                                                          | Capacity minus Children’s Capacity                                                                                                                                                             |                                                                                                                                                                                                |
| Other          | Usage minus Children’s Usage max(0, node_used - sum(child_used))         |                                                                          | Allocation minus Usage                                                                                                                                                                         |                                                                                                                                                                                                |
| Used           |                                                                          |                                                                          | Usage (the only piece of the chart that may have different colors. The color of this piece is based on its value: green if less than 85%, orange if between 85% and 95%, and red if above 95%) | Usage (the only piece of the chart that may have different colors. The color of this piece is based on its value: green if less than 85%, orange if between 85% and 95%, and red if above 95%) |
| Available      |                                                                          |                                                                          |                                                                                                                                                                                                | Available                                                                                                                                                                                      |
| Not Available  |                                                                          |                                                                          |                                                                                                                                                                                                | Capacity minus (Usage + Available)                                                                                                                                                             |
| Over Allocated | max (0, other + sum(child_used) + sum(child_not_used) - capacity)        |                                                                          |                                                                                                                                                                                                |                                                                                                                                                                                                |

موقع كل علامة على الرسم البياني يتناسب بدقة مع نسبة قيمتها إلى طول الرسم البياني. إذا كان موقع العلامة يتجاوز طول الرسم البياني، فإن موقعها المشار إليه لا يتناسب مع طول الرسم البياني، وهذا أيضاً يظهر في مظهر العلامة (خط منقط بدلاً من خط مستمر). القيم المشار إليها في العلامة في المعالج والذاكرة تتوافق مع المعلمات المستلمة من الطلب والحد، والتي تكون متطابقة بالنسبة للعقدة وغير العقدة. ومع ذلك، في القرص، القيمة المشار إليها مختلفة:

|          | Processor and Memory | Disk                       |
| -------- | -------------------- | -------------------------- |
| Node     | Request and Limit    | Total Capacity of Children |
| Non-node | Request and Limit    | Capacity                   |

### توضيح كل خلية في العرض المقاس

في هذا النوع من العرض، يتم قياس جميع القيم، بما في ذلك أطوال أجزاء الرسم البياني والمواقع المشار إليها للعلامات على الرسم البياني، بناءً على أقصى قيمة خاصة بتلك العمود (نوع المورد). في الواقع، يتم ضرب جميع هذه القيم في 100 ثم تقسيمها على الحد الأقصى المرغوب للحصول على نسبة تلك القيمة إلى الحد الأقصى لطول الرسم البياني (كنسبة مئوية). طريقة الحصول على الحد الأقصى لكل عمود هي كما يلي:

|                                 | معادلة                                                              | توضيح                                                                                                                                                                                                                                                                        |
| ------------------------------- | ------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Processor and Memory (Namspace) | max(max(request, used), min(max(request, used) \* 1.2, max(limit))) | أولاً، يتم أخذ القيمة القصوى بين الطلب واستخدام جميع الموارد في تلك العمود (أعلى طلب أو استخدام). يتم ضرب هذا الرقم في 1.2، ثم يتم أخذ الحد الأدنى بين هذه القيمة والحد الأقصى لذلك العمود. بعد ذلك، يتم مقارنة نتيجة هذا الحد الأدنى مع نفس الحد الأقصى للطلب أو الاستخدام. |
| Processor and Memory (Node)     | max(capacity)                                                       | الحد الأقصى لسعة الموارد في تلك العمود                                                                                                                                                                                                                                       |
| Disk                            | max(capacity)                                                       | الحد الأقصى لسعة الأقراص في تلك العمود (SSD أو HDD)                                                                                                                                                                                                                          |

الفرق الآخر بين هذه الطريقة في العرض والطريقة الافتراضية لها هو أنه قد يتم ضغط بعض أجزاء الرسم البياني هنا. وهذا يعني أنه بسبب اختيار الحد الأقصى، قد يتجاوز مجموع طول أجزاء الرسم البياني في بعض الأحيان 100% من الحد الأقصى المسموح به لطول الرسم البياني؛ وبالتالي، يتم عرض بعض الأجزاء أقل من نسبتهم الفعلية. كما أن هذا التغيير في تمثيل هذه الأجزاء ينعكس أيضاً، وتظهر هذه الأجزاء بشكل متقطع. بالنسبة للعلامات، طالما أن قيمها لا تتجاوز الحد الأقصى، فإن موقعها المشار إليه دقيق؛ إذا تجاوزت الحد الأقصى، يتم تقديمها بطريقة مماثلة لما تم ذكره في الطريقة الافتراضية.

#### قانون ضغط أجزاء الرسم البياني هو كما يلي

إذا كان مجموع طول أجزاء الرسم البياني أقل من أو يساوي 100 (أي أن القيم الكلية أقل من أو تساوي الحد الأقصى)، فلن يحدث أي ضغط. إذا كان هذا المجموع أكبر، نبدأ من نهاية الرسم البياني ونزيل الأجزاء واحدة تلو الأخرى حتى يصبح مجموع طول الأجزاء المتبقية أقل من 100. من بين هذه الأجزاء الأخيرة من الرسم البياني، نبدأ بإضافة الأجزاء من الأصغر حتى لا يتجاوز المجموع 100%. الأجزاء التي تبقى تحتاج إلى الضغط. الآن، نقسم الطول اللازم لملء الرسم البياني إلى 100 على عدد الأجزاء التي تم حذفها، مما يعطي جميع الأجزاء المحذوفة طولاً متساويًا، ونوضح ضغطها (عدم دقة نسبة الحجم) من خلال تغيير التمثيل.
